---
layout: post
title:  "iOS에서 네트워크 통신하기"
date:   2018-08-28 20:21:00 +0900
categories: iOS networking
---

### iOS에서 네트워크 통신을 어떻게 할까?

> 네트워크 통신에 사용하는 용어 개념과 이를 구현하기 위해 사용하는 인터페이스를 알아보자.

#### 0. 네트워크 관련 용어들

트랜젝션: HTTP 트랜젝션은 요청 명령과 응답 결과로 구성되어 있다.

프락시: 클라이언트와 서버 사이에 위치한 HTTP 중개자. 주로 보안을 위해서 사용된다. 무언가 다운 받을 때 바이러스 검출하는 등 요청과 응답을 필터링 한다.

캐시: 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고

게이트웨이: 다른 애플리케이션과 연결된 특별한 웹 서버. 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다. 

터널: 단순히 HTTP 통신을 전달하기만 하는 특별한 프락시. 주로 비 HTTP 데이터를 하나 이상의 HTTP  연결을 통해 그대로 전송해주기 위해 사용된다.

#### 1. URL Loading System

URL Loading System은 URL을 통해 리소스에 접근한다. 이 작업은 비동기로 처리되기 때문에 다른 작업을 동시에 처리할 수 있다. URLSession 인스턴스를 사용하여 하나 이상의 URLSessionTask 인스턴스를 만들면 데이터를 가져 와서 응용 프로그램에 반환하거나 파일을 다운로드하거나 데이터 및 파일을 원격 위치에 업로드 할 수 있다. 

#### 2. Fetching Website Data into Memory

원격 서버와의 상호 작용을 위해 URLSessionDataTask 클래스를 사용하여 응답 데이터를 메모리로 수신 할 수 있다 (URLSessionDownloadTask 클래스를 사용하면 파일 시스템에 직접 데이터를 저장함). 데이터 작업은 웹 서비스 끝점 호출과 같은 용도에 이다.

URL 세션 인스턴스를 사용하여 task를 만든다. 작업이 비교적 간단하다면 URLSession 클래스의 공유 인스턴스를 사용할 수 있다. 델리게이트 콜백을 통해 전송과 상호 작용하려는 경우 공유 인스턴스를 사용하는 대신 세션을 만들어야 한다. 세션을 만들 때 URLSessionConfiguration 인스턴스를 사용하고 URLSessionDelegate 또는 해당 하위 프로토콜 중 하나를 구현하는 클래스를 전달한다. 세션은 여러 작업을 생성하기 위해 재사용 할 수 있으므로 필요로하는 고유 한 구성마다 세션을 만들어 속성으로 저장한다.